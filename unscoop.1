.Dd May 20, 2020
.Dt UNSCOOP 1
.Os
.
.Sh NAME
.Nm unscoop
.Nd import IRC logs
.
.Sh SYNOPSIS
.Nm
.Op Fl nv
.Op Fl N Ar network
.Op Fl c Ar context
.Op Fl d Ar path
.Op Fl f Ar format
.Ar
.
.Nm
.Op Fl d Ar path
.Fl D
.
.Sh DESCRIPTION
The
.Nm
utility imports IRC client logs into the
.Xr litterbox 1
database.
The network and channel or query names
can be inferred from file paths,
so it is best to run
.Nm
from the log directory root
or use absolute paths.
.
.Pp
The arguments are as follows:
.Bl -tag -width Ds
.It Fl D
Delete duplicate events from overlapping imports.
This operation requires SQLite version 3.25.0 or newer.
.
.It Fl N Ar network
Override the network name of the imported logs.
.
.It Fl c Ar context
Override the channel or query name
of the imported logs.
Names beginning with
.Ql #
or
.Ql &
are assumed to be channels.
.
.It Fl d Ar path
Set the database path,
which must have been initialized by
.Xr litterbox 1 .
The default path is as in
.Xr litterbox 1 .
.
.It Fl f Ar format
Set the input log format to one of
.Cm catgirl ,
.Cm generic ,
.Cm irc ,
.Cm textual .
.
.Pp
The default format is
.Cm generic ,
which matches paths of the form
.Pa network/context/*
and events of the following forms:
.Bd -literal -offset indent
[timestamp] <nick> privmsg
[timestamp] -nick- notice
[timestamp] * nick action
.Ed
.
.Pp
The
.Cm irc
format matches IRC protocol messages tagged with
.Sy server-time .
The network and context must be set with
.Fl N
and
.Fl c .
.
.It Fl n
Do not import any files.
Compile regular expressions and exit.
.
.It Fl v
Print SQL
.Sy INSERT
statements on standard error.
.El
.
.Sh EXAMPLES
.Bd -literal
find catgirl -type f -name '*.log' -print0 | xargs -0 unscoop -f catgirl
find Textual -type f -name '*.txt' -not -path '*/Console/*' -print0 \e
	| xargs -0 unscoop -f textual
.Ed
.
.Sh SEE ALSO
.Xr litterbox 1
.
.Sh AUTHORS
.An June Bug Aq Mt june@causal.agency
.
.Sh BUGS
Send mail to
.Aq Mt list+litterbox@causal.agency
or join
.Li #ascii.town
on
.Li chat.freenode.net .
